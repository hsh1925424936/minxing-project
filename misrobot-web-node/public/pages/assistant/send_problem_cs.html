<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../../js/assistant/layout.js" ></script>
		<meta charset="UTF-8">
		<title>发送题目</title>
		<style type="text/css">
			body{
				padding-bottom:0;
			}
			.mainOuter{
				width:750px; height:420px; padding-left:30px; padding-right:30px;
			}
			.topCon{
				width:100%; height:60px;
				color:rgb(51,51,51);
			}
			.topCon h2{
				height:100%; float:left; line-height:60px; font-size:19px;
			}
			.topCon span{
				width:22px; height:22px; float:right; display:block; position:relative;
				top:50%; margin-top:-11px; cursor:pointer;
				background-image:url('../../images/assistant/guanbi-tanchuang.png');
				background-size:100% 100%;
				background-repeat:no-repeat;
			}
			.topCon img{
				width:100%; height:100%; display:none;
			}
			.topCon span:hover img{
				display:block;
			}

			.mainCon{
				width:100%; height:255px; 
			}
			.problemOuter{
				width:60%; height:100%; float:left; border-right:1px solid #ccc;
			}
			.problemCon{
				width:100%; padding:10px;
			}
			.problemCon span{
				display:block; border-radius:18px; width:28px; height:28px;
				float:left; text-align:center; line-height:28px; font-size:12px;
				color:white; margin-right:10px;
			}
			.judge_span{
				background-color:#0495CA;
			}
			.choice_span{
				background-color:#2CC877;
			}
			.essay_span{
				background-color:#FFC928;
			}
			.problemCon p{
				float:left; font-size:14px; line-height:20px; padding-top:5px;
				width:340px;
			}
			.hidden_left{
				width:100%; float:left; min-height:45px; padding-right:20px;
				color:rgb(51,51,51); padding-left:30px;
			}
			.hidden_left>p{
				width:100%; font-size:16px;
				line-height:20px; padding-top:10px;
			}
			.hidden_left>h4{
				width:100%; line-height:18px; font-size:14px; padding-top:5px; padding-bottom:5px;
			}

			.timeOuter{
				width:40%; height:100%; float:left;
				-moz-user-select:none; -webkit-user-select:none; 
  				-ms-user-select:none; -khtml-user-select:none; 
			}
			.timeCon{
				width:240px; margin:auto; margin-top:20px;
			}
			.timeCon>h4{
				width:100%; font-size:15px; color:#676767; text-align:center;
				margin-bottom:40px;
			}
			
			.timeBox{
				width:100%; height:155px;
				text-align:center; line-height:148px;
			}
			.timeBox>div{
				height:100%; float:left; text-align:center;
			}
			.minOuter,.secondOuter{
				width:95px; border:1px solid #ccc; cursor:pointer;
			}
			.minOuter:hover,.secondOuter:hover{
				background-color:#CBCBCB;
			}

			.middle{
				width:45px; font-size:56px;
			}
			.timeBox>div>p{
				width:100%; height:72px; font-size:56px; line-height:72px;
			}
			.timeBox>div>span{
				width:100%; height:38px; font-size:40px; line-height:38px; display:block;
				color:white;
			}

			.footerBtn{
				width:100%; height:38px; position:absolute; bottom:20px; right:30px;
			}
			.footerBtn button{
				display:block; float:right; width:112px; height:38px; border-radius:3px;
				font-size:16px; text-align:center; line-height:38px; box-sizing:border-box;
			}
			.closeBtn,.saveandnew{
				border:1px solid #c3c3c3; background-color:#ffffff;
			}
			.saveandnew{
				margin-right:10px;
			}
			.closeBtn:hover,.saveandnew:hover{
				background-color:#f2f2f2; border:1px solid #999999;
			}
			.saveBtn{
				background-color:#0496ca; margin-right:20px; color:white;
			}
			.saveBtn:hover{
				background-color:#0487b5;
			}
		</style>	
		
		
	</head>
	<body>
		<div class="mainOuter">
			<div class="topCon">
				<h2>发送题目</h2>
				<span class="closeSpan">
					<img src="../../images/assistant/guanbi-tanchuang-h.png">
				</span>
				
			</div>

			<div class="mainCon">
				<div class="problemOuter">
					<div class="problemCon clearfix">
						<span class="choice_span">
							选
						</span>
						<p>
							疑为胸腔包虫病患者，穿刺可引起感染扩散，不宜穿刺。( )
						</p>
					</div>

					<div class="hidden_left">
						<h4>A、锁骨中线第2肋间</h4>
						<h4>B、锁骨中线第2肋间</h4>
						<h4>C、锁骨中线第2肋间</h4>
						<h4>D、锁骨中线第2肋间</h4>
						<h4>E、锁骨中线第2肋间</h4>
						<p>
							<span>正确答案：</span>A
						</p>
					</div>

				</div>
				<div class="timeOuter">
					<div class="timeCon">
						<h4>请选择时间</h4>
						<div class="timeBox">
							<div class="minOuter">
								<span class="minute_min">-</span>
								<p class="minute">01</p>
								<span class="minute_add">+</span>
							</div>
							<div class="middle">
								:
							</div>
							<div class="secondOuter">
								<span class="second_min">-</span>
								<p class="second">00</p>
								<span class="second_add">+</span>
							</div>
						</div>

					</div>
				</div>
			</div>

			<div class="footerBtn">
				<button class="closeBtn">取消</button>
				<button class="saveBtn">提问</button>
			</div>

		</div>

	</body>
	
	<script type="text/javascript">
		if( GetQueryString('type') == 'qiangda' ){//把提问按钮改成抢答
			$('.saveBtn').html('抢答');
		}
		

		$('.minute_min').click(function() {
			var minute = parseInt($('.minute').html());
			if( minute < 1 ){
				minute = 5;
			}else{
				minute--;
			}
			$('.minute').html(addzero(minute));
		});

		$('.second_min').click(function() {
			var second = parseInt($('.second').html());
			if( second < 1 ){
				second = 59;
			}else{
				second--;
			}
			$('.second').html(addzero(second));
		});
		$('.minute_add').click(function() {
			var minute = parseInt($('.minute').html());
			if( minute > 4 ){
				minute = 0;
			}else{
				minute++;
			}
			$('.minute').html(addzero(minute));
		});
		$('.second_add').click(function() {
			var second = parseInt($('.second').html());
			if( second > 58 ){
				second = 0;
			}else{
				second++;
			}
			$('.second').html(addzero(second));
		});

		//滑动设置倒计时时间
		$('.minOuter')[0].addEventListener("DOMMouseScroll", function(e) {
			if ( e.detail < 0 ){//增加数值
				var minute = parseInt($('.minute').html());
				if( minute > 4 ){
					minute = 0;
				}else{
					minute++;
				}
				$('.minute').html(addzero(minute));
			}else{
				var minute = parseInt($('.minute').html());
				if( minute < 1 ){
					minute = 5;
				}else{
					minute--;
				}
				$('.minute').html(addzero(minute));
			}
		});

		$('.secondOuter')[0].addEventListener("DOMMouseScroll", function(e) {
			if ( e.detail < 0 ){//增加数值
				var minute = parseInt($('.second').html());
				if( minute > 58 ){
					minute = 0;
				}else{
					minute++;
				}
				$('.second').html(addzero(minute));
			}else{
				var minute = parseInt($('.second').html());
				if( minute < 1 ){
					minute = 59;
				}else{
					minute--;
				}
				$('.second').html(addzero(minute));
			}
		});

		$('.minOuter')[0].onmouseover = function(){
			$('body')[0].addEventListener("DOMMouseScroll", function(e) {
				return false;
			});
		}

		$('.minOuter')[0].onmouseout = function(){
			$('body')[0].removeEventListener('DOMMouseScroll',function(){},false);
		}

		$('.secondOuter')[0].onmouseover = function(){
			$('body')[0].addEventListener("DOMMouseScroll", function(e) {
				return false;
			});
		}

		$('.secondOuter')[0].onmouseout = function(){
			$('body')[0].removeEventListener('DOMMouseScroll',function(){},false);
		}

		function show_problem(){//显示问题
			$('.problemOuter').html('');
			var questionbaseid = GetQueryString('questionbaseid');
			var json = {
				'1':{
					command:'question/querysinglequestion', //接口地址
					questionbaseid:questionbaseid,
					sessionid:getCookie('sid'),
					loginid:getCookie('loginid')
				}
			};

			Api.dataToJava({
				json:{
					url:'/question/querysinglequestion', //一次性走几个接口
					data:JSON.stringify(json)
				},
				fn:function (base) {
					base = base[1]; //取接口的第一个返回值
					console.log(base);
					
					//判断接口是否走成功， errcode为0是成功
					if (base.errcode!=0) {
						uselayer(3,base.errdesc);
						return false;
					}

					ask();//点击提问按钮
					var str = '';
					var cateid = base.cateid;
					if( cateid == 1 || cateid == 2 ){//单选或者多选
						str +=
						'<div class="problemCon clearfix">'+
							'<span class="choice_span">'+
								'选'+
							'</span>'+
							'<p>'+
								base.name+'( )'+
							'</p>'+
						'</div>'+
						'<div class="hidden_left">';
							for ( var j = 0; j < base.questionitem.length; j++ ){
								var name = base.questionitem[j].itemname;
								var content = base.questionitem[j].content;
								str +=
								'<h4>'+name+'、'+content+'</h4>';
							}
							str +=
							'<p><span>正确答案：</span>'+base.answer+'</p>'+
						'</div>';
					}else if ( cateid == 5 ){//问答题
						// str +=
						// '<div class="problemCon clearfix">'+
						// 	'<span class="essay_span">'+
						// 		'问'+
						// 	'</span>'+
						// 	'<p>'+
						// 		problem_list[0].name+
						// 	'</p>'+
						// '</div>'+
						// '<div class="hidden_left">'+
						// 	'<p><span>正确答案：</span>'+problem_list[0].answer+'</p>'+
						// '</div>';
					}else if ( cateid == 4 ){//判断题
						var answer = '正确';
						if( base.answer == 0 ){
							answer = '错误';
						}
						str +=
						'<div class="problemCon clearfix">'+
							'<span class="judge_span">'+
								'判'+
							'</span>'+
							'<p>'+
								base.name+
							'</p>'+
						'</div>'+
						'<div class="hidden_left">'+
							'<p><span>正确答案：</span>'+answer+
						'</div>';
					}
					
					$('.problemOuter').html(str);
				}
			});
		}

		function ask(){//点击提问按钮
			$('.saveBtn').click(function() {
				var qid = GetQueryString('qid');
				var questionbaseid = GetQueryString('questionbaseid');
				var type = GetQueryString('type');
				var scheduleid = GetQueryString('scheduleid');
				var cateid = GetQueryString('cateid');
				var minute = $('.minute').html();
				var second = $('.second').html();
				var url ='';
				if ( type == 'ask' ){
					url = 'ask_question.html?qid='+qid+'&minute='+minute+'&second='+second+'&scheduleid='+scheduleid+'&cateid='+cateid+'&questionbaseid='+questionbaseid;
					type = 0;
				}else{
					url = 'qiangda.html?qid='+qid+'&minute='+minute+'&second='+second+'&scheduleid='+scheduleid+'&cateid='+cateid+'&questionbaseid='+questionbaseid;
					type = 1;
				}

				minute = parseInt(minute);
				second = parseInt(second);
				var deadline = minute*60+second;
				var json = {
					'1':{
						command:'question/questionsend', //接口地址
						scheduleid:scheduleid,
						qid:qid,
						type:type,
						deadline:deadline,
						sessionid:getCookie('sid'),
						loginid:getCookie('loginid')
					}
				};

				Api.dataToJava({
					json:{
						url:'/question/questionsend', //一次性走几个接口
						data:JSON.stringify(json)
					},
					fn:function (base) {
						base = base[1]; //取接口的第一个返回值
						console.log(base);
						
						//判断接口是否走成功， errcode为0是成功
						if (base.errcode!=0) {
							uselayer(3,base.errdesc);
							return false;
						}

						parent.location.href = url;
					}
				});

			});
		}

        show_problem();//展示问题
           
	</script>

</html>
