<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../../js/iteach/layout.js" ></script>
		<meta charset="UTF-8">
		<title>本周课程</title>
		<style type="text/css">
			body{
				background-color:#fff;
			}
			.box{
				 padding-bottom:50px;
			}
			.outer{
				width:100%;
			}

			.timeOuter{
				width:100%; height:36px; font-size:15px; line-height: 36px; background: #eff3f6;
			}
			.month{
				float: left; width: 20%; text-align: center;font-size:15px; color:rgb(51,51,51);
			}
			.year{
				float: left; width: 80%; text-align: right; padding-right: 1em;
				color:rgb(153,153,153); font-size:12px;
			}

			.dayOuter{
				width:100%; padding-left:10px; padding-right:10px;
				margin-top:20px;
			}
			.dayCon{
				width:100%; margin-bottom:0; border-bottom: 1px solid #ccc;
			}
			.day{
				width:14%; float:left; font-size:8px; text-align: center; margin-top: 20px;
			}
			.day p {
				font-size: 15px;
			}
			
			.lessonOuter{
				width:86%;  float:left; margin-left:0;
			}
			.timePart { float: left; width: 12%; margin: 22px 1%; margin-top: 22px; border-radius: 50%; color: #fff; text-align: center;}
			.timePart.time_1{
				background: green;
			}
			.timePart.time_2{
				background: orange;
			}
			.timePart.time_3{
				background: #111111;
			}
			.timePart.pass{
				background: #BBBBBB; color: #fff; font-size:12px;
			}
			.lessonCon{
				width:86%; float: left; padding:10px; 
			}
			.lessonCon div{
				width:50%; height:30px;
				line-height:30px; float:left;
			}
			.time{
				font-size:15px; color:rgb(0,0,0);
			}
			.address{
				text-align:right; font-size:14px; color:rgb(0,0,0);
			}
			.address1{
				color:#BBBBBB;
			}
			.address2{
				
			}
			.name{
				font-size:12px; color:rgb(51,51,51);
			}
			.txt{
				font-size:12px; text-align:right; color:rgb(51,51,51);
			}
			.pass,.pass .name,.pass .txt {color:rgb(102,102,102);}
			
		</style>
		<script>
			window.onload = function () {
				'use strict';
				webcommon();				
				$('.topRight').click(function () {
					window.location.href = "schedule.html";
				});
				
				var date = new Date();
				date.setHours(0,0,0,0);
				var _day = date.getDay();
				if (_day==0) {
					_day=7
				}				
				// _date.setDate(_date.getDate()-_day+1);
				var _date = date.getFullYear() + '-';
				var month = (date.getMonth() + 1).toString();
				var dd = (date.getDate()-_day+1).toString();
				_date += (month.length > 1) ? month : ( '0' + month );
				_date += '-';
				_date += (dd.length > 1) ? dd : ( '0' + dd );

				Api.R({
					url: "/course/querycousreinfo"
					isShade:1,
					json:{
						"1": {
							command: "course/querycousreinfo",
							uid: getCookie('gy_u'),
							sessionid: getCookie('gy_t'),
							timetype: 2
						}
					},
					fn:function (data) {
						if(data["1"].errcode){
							uselayer(3, data["1"].errdesc);
							return;
						}
						var _arr = data["1"].schedules;
						$('.dayOuter').html('');
						var arr = {
									"1": {str: '', date: ''}, 
									"2": {str: '', date: ''}, 
									"3": {str: '', date: ''}, 
									"4": {str: '', date: ''}, 
									"5": {str: '', date: ''},
									"6": {str: '', date: ''}, 
									"0": {str: '', date: ''}
						};
						for (var i = _arr.length - 1; i >= 0; i--) {
							var _timeStr = '';
							if(_arr[i].starttime.substr(11,2) <= 12) {
								_timeStr = '上午';
							}else if(_arr[i].starttime.substr(11,2) <= 18){
								_timeStr = '下午';
							}else{
								_timeStr = '晚上';
							}
							var courseDay = (new Day(_arr[i].starttime)).getDay();
							var isPass = ((new Date(_arr[i].endtime).getTime()) > (new Date().getTime())) ? true : false;
							_str+= 
								'<div class="clearfix">'
								+'<div class="timePart time_'+courseDay+' '+(isPass ?'pass':'')+'">'+ _timeStr +'</div>'
								+'<div class="lessonCon clearfix '+(isPass?'pass':'')+'">'
								+'<div class="time">'+_arr[i].starttime.substr(11,5)+'-'+_arr[i].endtime.substr(11,5)+'</div>'
								+'<div class="address">'
								+'<span class="address1">技能中心 </span>'
								+'<span class="address2">' + _arr[i].roomnum+ '室</span>'
								+'</div>'
								+'<div class="name">'+_arr[i].coursename+'</div>'
								+'<div class="txt">上课人数：'+ _arr[i].totalstudents +'人</div>'
								+'</div></div>';

								arr[courseDay].str += _str;
								arr[courseDay].date = _arr[i].starttime;
						}

						var dayArr = [1,2,3,4,5,6,0];
						for(var i = 0, i < dayArr.length;i++){
							if(arr[dayArr[i]].str !== '') {
								var strDay = '';
								if((new Date()).getDay == dayArr[i]){
									strDay = '今天';
								}else{
									switch (dayArr[i]){
										case 1: strDay = '周一';
											break;
										case 2: strDay = '周二';
											break;
										case 3: strDay = '周三';
											break;
										case 4: strDay = '周四';
											break;
										case 5: strDay = '周五';
											break;
										case 6: strDay = '周六';
											break;
										default: strDay = '周日';
											break;
									}	
								}
								var dayStr = 
											'<div class="dayCon clearfix">'
											+'<div class="day">'
						 					+'<p>'+strDay+'</p>'
						 					+'<span>'+ arr[dayArr[i]].date.substr(5, 5) +'</span>'
						 					+'</div>'
						 					+'<div class="lessonOuter">'+arr[dayArr[i]].str+'</div>'
						 					+'</div>';

						 		$('.dayOuter').append(str);
								$('.timePart').css({'height':$('.timePart').css('width'),'line-height':$('.timePart').css('width')});
							}
						}

						if ($('.dayOuter').html()=='') {
							$('.dayOuter').html('<p class="no-data">本周暂无课程</p>');
						}
					}	
				});													
			};
			
			
		</script>
	</head>
	<body>
		
		<div class="box clearfix">
			<div class="outer clearfix">
				<div class="topOuter">
					<div class="return1">
						
					</div>
					<div class="topTxt">
						本周课程
					</div>
					<div class="topRight">
						今日
					</div>
				</div>

				<div class="timeOuter">
					<div class="month">本周</div>
					<div class="year">上课地址为技能中心楼</div>
				</div>

				<div class="dayOuter clearfix"></div>

				<div class="bottomOuter">
					<a href="schedule.html" class="bottomItem clearfix">
						<img src="../../images/iteach/kebiaoon.png"/>
						<span class="bottomItemOn">课表</span>
					</a>

					<a href="report.html" class="bottomItem clearfix">
						<img src="../../images/iteach/baogao.png"/>
						<span>报告</span>
					</a>

					<a href="message-list.html" class="bottomItem clearfix">
						<img src="../../images/iteach/message.png"/>
						<span>通知</span>
					</a>

					<a href="person-center.html" class="bottomItem clearfix">
						<img src="../../images/iteach/head2.png"/>
						<span>我</span>
					</a>
				</div>

			</div>

		</div>

	</body>
	
</html>
