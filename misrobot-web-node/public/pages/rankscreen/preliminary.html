<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../../js/rankscreen/layout.js" ></script>
		<meta charset="UTF-8">
		<title>初赛</title>
		<style type="text/css">
			body{
				width:100%; height:100%; overflow:hidden;
			}

			.titOuter{
				width:100vw; height:11vh; color:white; position:relative;
				font-weight:bold;
				background-image:url(../../images/rankscreen/paihang-top.png);
				background-repeat:no-repeat; background-size:100% 100%;
			}
			.titOuter img{
				width:7.3vh; height:7.3vh; float:left; display:block;
				margin-left:3.9vw; position:relative; top:50%; margin-top:-3.65vh;
			}
			.titOuter h2{
				height:100%; font-size:5.5vh; top:0; left:0; width:100%;
				line-height:11.5vh; position:absolute; text-align:center;
				font-weight:bold;
			}
			.th{
				width:100%; height:5.1vh; color:white; font-size:3.5vh;
				text-align:center; line-height:5.1vh; background-color:#005EB0;
				padding-left:1.4vw; padding-right:1.4vw;
			}
			.td{
				height:100%; float:left;
			}
			.td:nth-child(1),.td:nth-child(2),.td:nth-child(3){
				width:9.33%;
			}
			.td:nth-child(4),.td:nth-child(5),.td:nth-child(6),.td:nth-child(7),.td:nth-child(8),.td:nth-child(9),.td:nth-child(10){
				width:10.285%;
			}

			.emphasize_line{
				width:1.2vw; height:38.76vh; position:absolute;
				left:0; top:16.3vh; background-color:rgba(0,0,0,0.1);
			}

			.trCon{
				width:100%; text-align:center; line-height:6.46vh;
				color:white; font-size:3.8vh; background-color:#000000;
			}
			.tr{
				width:100%; height:6.46vh; padding-left:1.4vw; padding-right:1.4vw;
			}
			.tr:nth-child(1) .td:nth-child(1),.tr:nth-child(2) .td:nth-child(1),.tr:nth-child(3) .td:nth-child(1),.tr:nth-child(4) .td:nth-child(1),.tr:nth-child(5) .td:nth-child(1),.tr:nth-child(6) .td:nth-child(1){
				font-size:5.3vh; color:#fff000; font-weight:bold;
				text-shadow:0 0.5vh 0.5vh rgba(0,0,0,0.5);
			}
			.tr:nth-child(1),.tr:nth-child(3),.tr:nth-child(5){
				background-color:rgb(0,48,172);
			}
			.tr:nth-child(2),.tr:nth-child(4),.tr:nth-child(6){
				background-color:rgba(0,48,172,0.9);
			}
			.tr:nth-child(7),.tr:nth-child(9),.tr:nth-child(11){
				background-color:rgb(0,105,196);
			}
			.tr:nth-child(8),.tr:nth-child(10),.tr:nth-child(12){
				background-color:rgba(0,105,196,0.9);
			}
			.tr:nth-child(1) .td:nth-child(2),.tr:nth-child(1) .td:nth-child(3),
			.tr:nth-child(2) .td:nth-child(2),.tr:nth-child(2) .td:nth-child(3),
			.tr:nth-child(3) .td:nth-child(2),.tr:nth-child(3) .td:nth-child(3),
			.tr:nth-child(4) .td:nth-child(2),.tr:nth-child(4) .td:nth-child(3),
			.tr:nth-child(5) .td:nth-child(2),.tr:nth-child(5) .td:nth-child(3),
			.tr:nth-child(6) .td:nth-child(2),.tr:nth-child(6) .td:nth-child(3){
				font-weight:bold;
			}

			.footCon{
				width:100%; height:6.32vh; background-image:url(../../images/rankscreen/paihang-but.png);
				background-size:100% 100%; background-repeat:no-repeat;
			}
		</style>	
		
		
	</head>
	<body>
		<div class="titOuter">
			<img src="../../images/rankscreen/wuda_logo.png">
			<h2>武汉大学医学部第三届临床医学专业学生临床技能竞赛-初赛</h2>
		</div>
		<div class="th">
			<div class="td">
				排名
			</div>
			<div class="td">
				小组
			</div>
			<div class="td">
				总分
			</div>
			<div class="td">
				考完站数
			</div>
			<div class="td">
				第一站
			</div>
			<div class="td">
				第二站
			</div>
			<div class="td">
				第三站
			</div>
			<div class="td">
				第四站
			</div>
			<div class="td">
				第五站
			</div>
			<div class="td">
				第六站
			</div>
		</div>

		<div class="emphasize_line">

		</div>

		<div class="trCon">
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
			<div class="tr">
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
				<div class="td"></div>
			</div>
		</div>
		<div class="footCon">
			
		</div>

	</body>
	
	<script type="text/javascript">
		$(function() {
			showList();
			var t = setInterval(showList,30000);
		});

		function showList(){//展示初赛成绩列表
			var examid = GetQueryString('examid');//在地址栏中输入url?examid=x

			var json = {
				'1':{
					command:'osce/report/matchcurrentreport', //接口地址
					examid:examid
				}
			};

			Api.dataToJava({
				json:{
					url:'/osce/report/matchcurrentreport', //一次性走几个接口
					data:JSON.stringify(json)
				},
				fn:function (base) {
					base = base[1]; //取接口的第一个返回值
					console.log(base);
					
					//判断接口是否走成功， errcode为0是成功
					if (base.errcode!=0) {
						//uselayer(3,base.errdesc);
						return false;
					}

					var matchresult = base.matchresult.matchresult;
					// if( matchresult[0].finishstationcnt == 0 ){
					// 	return false;
					// }
					$('.trCon').html('');

					var sort_matchresult = [];
					for ( var i = 0; i < matchresult.length; i++ ){
						for ( var j = 0; j < matchresult.length; j++ ){
							if( matchresult[j].ranklist == (i+1) ){
								sort_matchresult.push(matchresult[j]);
							}
						}
					}
					var str = '';
					var length_temp = sort_matchresult.length;
					if ( length_temp > 12 ){
						length_temp = 12;
					}
					for ( var i = 0; i < length_temp; i++ ){
						var finishStand = 0;//完成站数
						var scoredetail = sort_matchresult[i].scoredetail.split('@');
						for ( var j = 0; j < scoredetail.length; j++ ){
							if( scoredetail[j] == '-' || !scoredetail[j] ){
								scoredetail[j] = '-';
							}else{
								scoredetail[j] = parseFloat(scoredetail[j]).toFixed(2);
								finishStand++;
							}
						}
						var scoredetail_length = scoredetail.length;
						for ( var j = scoredetail_length; j < 6; j++ ){
							scoredetail[j] = '-';
						}
						str += 
						'<div class="tr">'+
							'<div class="td">'+
								sort_matchresult[i].ranklist+
							'</div>'+
							'<div class="td">'+
								sort_matchresult[i].examineeid+'队'+
							'</div>'+
							'<div class="td">'+
								parseFloat(sort_matchresult[i].totalscore).toFixed(2)+
							'</div>'+
							'<div class="td">'+
								finishStand+
							'</div>'+
							'<div class="td">'+
								scoredetail[0]+
							'</div>'+
							'<div class="td">'+
								scoredetail[1]+
							'</div>'+
							'<div class="td">'+
								scoredetail[2]+
							'</div>'+
							'<div class="td">'+
								scoredetail[3]+
							'</div>'+
							'<div class="td">'+
								scoredetail[4]+
							'</div>'+
							'<div class="td">'+
								scoredetail[5]+
							'</div>'+
						'</div>';
					}
					if( sort_matchresult.length < 12 ){
						var time = 12 - sort_matchresult.length;
						for ( var i = 0; i < time; i++ ){
							str += 
							'<div class="tr">'+
								'<div class="td">'+
								'</div>'+
								'<div class="td">'+
								'</div>'+
								'<div class="td">'+
								'</div>'+
							'</div>';
						}
					}
					$('.trCon').html(str);

				}
			});
		}
	</script>

</html>
