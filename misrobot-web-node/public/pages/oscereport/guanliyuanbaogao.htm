<!DOCTYPE HTML>
<!-- saved from url=(0089)http://zd.aliyun.3322.org:8080/misrobot-service/report/managerreport -->
<!DOCTYPE html PUBLIC "" ""><HTML lang="en"><HEAD><META content="IE=11.0000" 
http-equiv="X-UA-Compatible">
     
<META charset="UTF-8">     
<META http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">     
<META name="viewport" content="width=device-width, initial-scale=1.0">     
<TITLE>管理者分析报告</TITLE>     <LINK href="guanliyuanbaogao_files/report.css" rel="stylesheet" 
type="text/css"> 
<SCRIPT src="guanliyuanbaogao_files/jquery-1.11.1.min.js" type="text/javascript" charset="utf-8"></SCRIPT>

<SCRIPT src="guanliyuanbaogao_files/echarts-all.js" type="text/javascript" charset="utf-8"></SCRIPT>

<SCRIPT src="guanliyuanbaogao_files/echarts.min.js" type="text/javascript" charset="utf-8"></SCRIPT>

<META name="GENERATOR" content="MSHTML 11.00.10570.1001"></HEAD> 
<BODY>
<DIV id="container">
<H2 id="testName">管理者分析报告</H2>
<DIV class="contentbox"><!--各考站成绩分析-->             
<DIV class="contentbox">
<TABLE width="100%" class="datalist" id="tabkeyvalue" border="0" cellspacing="0" 
cellpadding="0">
  <TBODY>
  <TR>
    <TD style="text-align: center; background-color: rgb(204, 204, 204);" 
    colspan="2">成绩关键点分值</TD></TR>
  <TR>
    <TD>项目</TD>
    <TD>分值</TD></TR>
  <TR>
    <TD>最高分</TD>
    <TD id="maxScore">-</TD></TR>
  <TR>
    <TD>中值</TD>
    <TD id="mediuScore">-</TD></TR>
  <TR>
    <TD>平均分</TD>
    <TD id="avgScore">-</TD></TR>
  <TR>
    <TD>最低分</TD>
    <TD id="minScore">-</TD></TR></TBODY></TABLE></DIV>
<DIV class="distrivution">成绩区段人数分布</DIV>
<DIV class="chart"><!--<div class="covar"></div>-->                 
<DIV id="main" style="width: 100%; height: 350px; float: left;"></DIV></DIV><!--试卷分析--> 
        
<DIV class="distrivution">试卷分析</DIV>
<DIV class="chart">
<DIV class="difficulty">难度：一般</DIV>
<DIV class="bord" id="main2" 
style="width: 100%; height: 240px; float: left;"></DIV></DIV>
<DIV class="chart">
<DIV class="difficulty">区分度：中</DIV>
<DIV class="bord" id="main3" 
style="width: 100%; height: 240px; float: left;"></DIV></DIV><!-- 考生成绩列表 -->     
    
<DIV class="contentbox">
<TABLE width="100%" class="datalist" id="tabscorelist" border="0" cellspacing="0" 
cellpadding="0">
  <TBODY>
  <TR>
    <TH style="text-align: center; background-color: rgb(204, 204, 204);" 
    colspan="7">考生成绩列表</TH></TR>
  <TR>
    <TH style="width: 20%;">排名</TH>
    <TH>姓名</TH>
    <TH>成绩</TH></TR></TBODY></TABLE></DIV></DIV></DIV>
<SCRIPT type="text/javascript">
	$( document ).ready(function() {
		  var jsondata = null;
		  var data = {"errcode":"0","errdesc":"success","reportinfo":{"rankinglist":[{"ranking":1,"score":320,"name":"陈玥"},{"ranking":2,"score":316,"name":"张贤丽"},{"ranking":3,"score":315,"name":"杨慧颖"},{"ranking":4,"score":313,"name":"贺新珏"},{"ranking":5,"score":313,"name":"张程"},{"ranking":6,"score":312,"name":"史悦"},{"ranking":7,"score":310,"name":"徐力"},{"ranking":8,"score":310,"name":"陈志烨"},{"ranking":9,"score":308,"name":"姚梦云"},{"ranking":10,"score":307,"name":"何灵哲"},{"ranking":11,"score":305,"name":"李铮"},{"ranking":12,"score":305,"name":"陶理"},{"ranking":13,"score":303,"name":"顾琳玲"},{"ranking":14,"score":300,"name":"黎玉燕"},{"ranking":15,"score":298,"name":"史飞娜"},{"ranking":16,"score":298,"name":"黄艺舟"},{"ranking":17,"score":297,"name":"王波"},{"ranking":18,"score":296,"name":"高星"},{"ranking":19,"score":296,"name":"卢晓雨"},{"ranking":20,"score":295,"name":"徐雯丽"},{"ranking":21,"score":294,"name":"姚裕"},{"ranking":22,"score":294,"name":"朱园润"},{"ranking":23,"score":293,"name":"徐经纬"},{"ranking":24,"score":293,"name":"韩璐阳"},{"ranking":25,"score":292,"name":"黄志恒"},{"ranking":26,"score":291,"name":"赵彼得"},{"ranking":27,"score":290,"name":"陈瑛"},{"ranking":28,"score":290,"name":"王宇坤"},{"ranking":29,"score":290,"name":"吴恒"},{"ranking":30,"score":290,"name":"石岩"},{"ranking":31,"score":288,"name":"冯晶晶"},{"ranking":32,"score":288,"name":"王华迪"},{"ranking":33,"score":287,"name":"王江南"},{"ranking":34,"score":286,"name":"王玮玮"},{"ranking":35,"score":286,"name":"俞叶乾"},{"ranking":36,"score":285,"name":"毛昳涵"},{"ranking":37,"score":284,"name":"林云霄"},{"ranking":38,"score":282,"name":"范嘉祺"},{"ranking":39,"score":279,"name":"张力"},{"ranking":40,"score":276,"name":"李永达"},{"ranking":41,"score":275,"name":"汤欢娜"},{"ranking":42,"score":274,"name":"詹天玮"},{"ranking":43,"score":274,"name":"金柯"},{"ranking":44,"score":272,"name":"姚蕴津"},{"ranking":45,"score":270,"name":"苏煜"},{"ranking":46,"score":267,"name":"吕云飞"},{"ranking":47,"score":265,"name":"虞浩"},{"ranking":48,"score":264,"name":"邓聿"},{"ranking":49,"score":262,"name":"周凌风"},{"ranking":50,"score":252,"name":"曾咏"}],"analysis":{"lowscorearray":[0,0,1,4],"highscorearray":[11,33,4,3],"degreearray":[0.7552083,0.8958333,0.79495615,0.71825397],"distinctionarray":[0.671875,0.50961536,0.5065789,0.5952381],"stationarray":["问诊1","临床操作","问诊2","体格检查"]},"keyvalue":{"totalcount":50,"minscore":252,"maxscore":320,"avgscore":291,"medianscore":291.5},"sectiondistribution":{"s70to80":12,"lessthan60":0,"s60to70":0,"s80to90":35,"morethan90":3},"basicinfo":{"testname":"2011级临床医学八年制学生医学综合考试II临床综合能力考核"},"rfss":350},"command":"osce/report/managerreport"};
		  if(data && (data.errcode == "0" || data.errcode == 0)){
			  jsondata = data.reportinfo;
		  }
        //console.log(jsondata);
        

        /*
		数据格式：{"1":{"command": "report/testreport", "errdesc":"invalid command.","errcode":"11",
		   	   "reportinfo":
		{
			"basicinfo": {
			    “testName” : “OSCE考试考官分析报告”,
			        "examiner": "李天玉",
			        "jobNo": "777888",
			        "station": "第二站－病史分析",
			        "classroom": "601-1",
			        "testWay": "OSCE"
			    },
			    "keyvalue": {
			        "maxScore": 90,
			        "mediuScore": 70,
			        "avgScore": 67.82,
			        "minScore": 48,
			        "passRate": 75.69,
			        "totalNum": 180
			    },
			    "sectiondistribution": {
			        "lessthan60": 9,
			        "s60to70": 82,
			        "s70to80": 41,
			        "s80to90": 34,
			        "morethan90": 14
			    }
			}}}
        */

        // 基于准备好的dom，初始化echarts实例
		if(jsondata){
			  $("#testName").text(jsondata.basicinfo.testname + "管理分析报告");
             
            //关键值
		    if(jsondata.keyvalue){
				if(jsondata.keyvalue.avgscore){
                  $("#avgScore1").text(jsondata.keyvalue.avgscore.toFixed(2));
				  $("#avgScore").text(jsondata.keyvalue.avgscore.toFixed(2));
			    }
              
                if(jsondata.keyvalue.maxscore){
                    $("#maxScore").text(jsondata.keyvalue.maxscore.toFixed(2));
				}

				if(jsondata.keyvalue.medianscore){
                    $("#mediuScore").text(jsondata.keyvalue.medianscore.toFixed(2));  
				}
                
                if(jsondata.keyvalue.minscore){
                    $("#minScore").text(jsondata.keyvalue.minscore.toFixed(2));
                }
			   
            }
            
            //饼状图

			if(jsondata.sectiondistribution && jsondata.keyvalue){
				var myChart = echarts.init(document.getElementById('main'));

				option = {
					title : {
						text: '总人数：' + jsondata.keyvalue.totalcount + '人',
						subtext: '',
						x:'left',
			            textStyle: {
			                fontSize: 12
			            }
					},
					tooltip : {
						trigger: 'axis',
						formatter: "{a} <br/>{b} : {c} ({d}%)"
					},
					textStyle: {
			            fontSize: 8
			        },
					legend: {
						orient: 'vertical',
						left: 'left',
						data: [''+(jsondata.rfss*0.6).toFixed(2)+'分以下：' + jsondata.sectiondistribution.lessthan60 + '人',
							''+(jsondata.rfss*0.6).toFixed(2)+'－'+(jsondata.rfss*0.7).toFixed(2)+'分：' + jsondata.sectiondistribution.s60to70 + '人',
							''+(jsondata.rfss*0.7).toFixed(2)+'－'+(jsondata.rfss*0.8).toFixed(2)+'分：' + jsondata.sectiondistribution.s70to80 + '人',
							''+(jsondata.rfss*0.8).toFixed(2)+'－'+(jsondata.rfss*0.9).toFixed(2)+'分：' + jsondata.sectiondistribution.s80to90 + '人',
							''+(jsondata.rfss*0.9).toFixed(2)+'－'+jsondata.rfss.toFixed(2)+'分：' + jsondata.sectiondistribution.morethan90 + '人'],
							
				        itemWidth: 13,
				        top: '22'
					},
					series : [
						{
							name: '访问来源',
							type: 'pie',
							radius : '55%',
							center: ['50%', '60%'],
							data:[
								{value: jsondata.sectiondistribution.lessthan60, name:''+(jsondata.rfss*0.6).toFixed(2)+'分以下：' + jsondata.sectiondistribution.lessthan60 + '人'},
								{value: jsondata.sectiondistribution.s60to70, name:''+(jsondata.rfss*0.6).toFixed(2)+'－'+(jsondata.rfss*0.7).toFixed(2)+'分：' + jsondata.sectiondistribution.s60to70 + '人',},
								{value: jsondata.sectiondistribution.s70to80, name:''+(jsondata.rfss*0.7).toFixed(2)+'－'+(jsondata.rfss*0.8).toFixed(2)+'分：' + jsondata.sectiondistribution.s70to80 + '人'},
								{value: jsondata.sectiondistribution.s80to90, name:''+(jsondata.rfss*0.8).toFixed(2)+'－'+(jsondata.rfss*0.9).toFixed(2)+'分：' + jsondata.sectiondistribution.s80to90 + '人'},
								{value: jsondata.sectiondistribution.morethan90, name:''+(jsondata.rfss*0.9).toFixed(2)+'－'+jsondata.rfss.toFixed(2)+'分：' + jsondata.sectiondistribution.morethan90 + '人'}
							],
							itemStyle: {
								emphasis: {
									shadowBlur: 10,
									shadowOffsetX: 0,
									shadowColor: 'rgba(0, 0, 0, 0.5)'
								}
							}
						}
					]
				};

	
				// 使用刚指定的配置项和数据显示图表。
				myChart.setOption(option);
				
            }

            //难度与区分度
			if(jsondata.analysis){
				
                jsondata.analysis.stationarray.push('考站');
                for(var i=0;i<jsondata.analysis.degreearray.length;i++){
                	jsondata.analysis.degreearray[i] = jsondata.analysis.degreearray[i].toFixed(2);
                }
                
                for(var i=0;i<jsondata.analysis.distinctionarray.length;i++){
                	jsondata.analysis.distinctionarray[i] = jsondata.analysis.distinctionarray[i].toFixed(2);
                }
                
                jsondata.analysis.degreearray.push('考题');
                jsondata.analysis.distinctionarray.push('考题');
				
				
				//
				// 试卷分析
			    // 难度：容易
			    var myChart2 = echarts.init(document.getElementById('main2'));
			    option = {
			        title: {
			            text: '',
			            textStyle: {
			                fontSize: 12
			            }
			        },
			        tooltip : {
			            trigger: 'axis'
			        },
			        grid: {
			            left: '3%',
			            right: '4%',
			            bottom: '3%',
			            containLabel: true
			        },
			        xAxis : [
			            {
			                type : 'category',
			                boundaryGap : false,
                            data: jsondata.analysis.stationarray
			            }
			        ],
			        yAxis : [
			            {
			                name : '难度',
			                type : 'value'
			            }
			        ],
			        
			        itemStyle : {
			            normal : {
			                color:'#e89305',
			                lineStyle:{
			                    color:'#f09f18'
			                }
			            }
			        },
			        
			        series : [
			            {
			                name:'难度',
			                type:'line',
			                stack: '总量',
			                label: {
			                    normal: {
			                        show: true,
			                        position: 'top'
			                    }
			                },
			                areaStyle: {normal: {}},
							data: jsondata.analysis.degreearray
			            }
			        ]
			    };
			    myChart2.setOption(option);

			    // 区分度：中等
			    var myChart3 = echarts.init(document.getElementById('main3'));
			    option = {
			        title: {
			            text: '',
			            textStyle: {
			                fontSize: 12
			            }
			        },
			        tooltip: {
			            trigger: 'axis'
			        },
			        
			        grid: {
			            left: '3%',
			            right: '4%',
			            bottom: '3%',
			            containLabel: true
			        },
			        xAxis : [
			                 {
			                     type : 'category',
			                     boundaryGap : false,
			                     data : jsondata.analysis.stationarray
			                 }
			             ],
			             yAxis : [
			                 {
			                     name : '区分度',
			                     type : 'value'
			                 }
			             ],
			             itemStyle : {
			                 normal : {
			                     color:'#589913',
			                     lineStyle:{
			                         color:'#c1d9a7'
			                     }
			                 }
			             },
			             series : [
			                 {
			                     name:'难度',
			                     type:'line',
			                     stack: '总量',
			                     label: {
			                         normal: {
			                             show: true,
			                             position: 'top'
			                         }
			                     },
			                     areaStyle: {normal: {}},
			                     data:jsondata.analysis.distinctionarray
			                 }
			             ]
			    };
			    myChart3.setOption(option);
			}
        }
        
        
		// 学生成绩列表
        if(jsondata.rankinglist){
           
		  var $tabscorelist = $("#tabscorelist");

		  for(var i=0; i< jsondata.rankinglist.length; i++){
              
			var tmpstr = "<tr>";
            var str1 = "<td style='width: 20%'>" +  jsondata.rankinglist[i].ranking + "</td>";
			tmpstr = tmpstr + str1;
			
            var str2 = "<td>" +  jsondata.rankinglist[i].name + "</td>";
			tmpstr = tmpstr + str2;
			
			var str3 = "<td>" +  jsondata.rankinglist[i].score.toFixed(2) + "</td>";
		    tmpstr = tmpstr + str3;
		  
		    tmpstr = tmpstr + "</tr>";
		  
		    $tabscorelist.append(tmpstr);
		 
		  }
  
       }
    });   

    </SCRIPT>
 </BODY></HTML>
