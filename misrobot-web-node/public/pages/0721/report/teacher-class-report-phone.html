<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../common/js/layout.js" ></script>
		<meta charset="UTF-8">
		<title>老师班级报告</title>
		<style>
			html,body{height:100%;}
			.report_all{
				height:100%; background-color:#EFF4F9; overflow:auto; padding-bottom:30px;
			}
			.title{/*标题*/
				width:100%; height:40px; background-color:#3499DB;
				color:white; font-size:20px; line-height:40px; text-align:center;
			}
			.report_con{
				overflow:hidden;
			}
			.report_block{
				background-color:white; margin-top:10px; box-shadow:0px 2px 2px #E0E7EF;
			}

			.report_block1{
				padding:5px 30px;
			}
			.report_block1 p{
				margin:10px 0;
			}

			.report_block2{
				padding:15px 10px;
			}
			.tab_con{
				width:100%; margin-bottom:30px;
			}
			.tab_con li{
				box-shadow:1px 2px 2px #D2E9F7; border-radius:2.5px;
				text-align:center; height:66px; width:16%; text-align:center;
				cursor:pointer; overflow:hidden; float:left; margin:0 2%;
				padding-top:3px;
			}
			.tab_on{
				background-color:#3499DB; color:white;
			}
			
			.score_con{
				width:100%; margin-bottom:30px;
			}
			.score_con p{
				width:33.3%; text-align:center; font-size:16px; float:left;
			}
			.score_con p:nth-child(1) span{
				color:#3499DB;
			}
			.score_con p:nth-child(2) span{
				color:#FFA800;
			}
			.score_con p:nth-child(3) span{
				color:#FF0000;
			}
			.person_time{
				width:290px; height:53px; margin:0 auto;
			}
			.person_time>div{float:left; height:100%;}
			.person_time>div:nth-child(1){width:23%;}
			.person_time>div:nth-child(2){width:77%; padding-left:20px; position:relative;}
			.person_time>div:nth-child(1) img{
				display:block; border-radius:5px; height:100%;
			}
			.person_time_inner{position:absolute; bottom:0;}
			.person_time_inner h2{
				font-size:20px; width:100%;
			}
			.person_time_inner h2 span{
				color:#FFA800; font-size:25px;
			}

			.report_block3{
				padding:15px 20px;
			}
			.stu_score_con{
				width:100%; height:55px; line-height:55px; background-color:#FAFCFE;
				border:1px solid #DFE2E5; margin:10px 0; border-radius:4px;
				color:#4C6072; overflow:hidden;
			}
			.stu_score_con span{
				height:100%; display:block; float:left; text-align:center;
			}
			.stu_score_con span:nth-child(1){
				width:30%; font-size:20px;
			}
			.stu_score_con span:nth-child(2){
				width:25%; font-size:20px;
			}
			.stu_score_con span:nth-child(3){
				width:30%;
			}
			.stu_score_con span:nth-child(4){
				width:15%;
			}
		</style>	
	</head>
	<body>
        <div class="report_all" id="vue_control" v-cloak>
        	<!-- <div class="title">
        		老师班级报告
        	</div> -->
        	<div class="report_con">
        		<div class="report_block report_block1">
        			<p>班级：{{classname}}</p>
        			<p>上课人数：{{classstdcount}}人</p>
        			<p>
        				上课时间：
        				<template v-if="starttime">
        					{{starttime.toString().substr(0,16)}}-{{endtime.split(' ')[1].substr(0,5)}}
        				</template>
        			</p>
        		</div>

        		<div class="report_block report_block2 clearfix">
        			<ul class="tab_con clearfix">
        				<li :class="tab_on(0)" @click="change_type(0)">课前自<br/>主在线<br/>训练</li>
        				<li :class="tab_on(1)" @click="change_type(1)">课上训<br/>练机器<br/>人</li>
        				<li :class="tab_on(2)" @click="change_type(2)">课上训<br/>练模型<br/>人</li>
        				<li :class="tab_on(3)" @click="change_type(3)">课后自<br/>主预约<br/>训练</li>
        				<li :class="tab_on(4)" @click="change_type(4)">OSCE<br/>考试</li>
        			</ul>
    				<div class="score_con clearfix">
    					<p>平均分:<span>{{parseFloat(avgscore?avgscore:0).toFixed(1)}}</span></p>
    					<p>最高分:<span>{{parseFloat(maxscore?maxscore:0).toFixed(1)}}</span></p>
    					<p>最低分:<span>{{parseFloat(minscore?minscore:0).toFixed(1)}}</span></p>
    				</div>

    				<!-- 人次 -->
    				<div class="person_time clearfix">
    					<div>
    						<img :src="img[current_type2]">
    					</div>
    					<div>
    						<div class="person_time_inner">
    							<h2><span>{{trainstdcount}}</span>人次<br/>参与{{type[current_type2]}}</h2>
    						</div>
    					</div>
	    				
    				</div>
    				
        		</div>

        		<div class="report_block report_block3">
        			<div v-for="(item,i) in order" class="stu_score_con">
    					<span>{{item.name}}</span><span>{{parseFloat(item.score?item.score:0).toFixed(1)}}分</span>
    					<span>{{item.endtime.split(' ')[0]}}</span>
    					<span>{{item.endtime.split(' ')[1].substr(0,5)}}</span>
    				</div>
        		</div>

        	</div>
        </div>
	</body>
	<script type="text/javascript">

		var vm=new Vue({
			el:"#vue_control",
			data:{
				classname:'',
				classstdcount:'',
				starttime:'',
				endtime:'',

				minscore:0,
				avgscore:0,
				trainstdcount:0,
				maxscore:0,
				order:[],
				current_type:0,
				current_type2:0,
				img:['../common/images/@.png','../common/images/smart_train.png','../common/images/model_train.png','../common/images/subscribe_train.png','../common/images/osce_exam.png'],
				type:['在线自主训练','课上机器人训练','课上模型人训练','课后自主预约训练','OSEC考试'],//报告类型
				type_map:[2,3,4,5,1]//type映射表(对应传给后端的字段)
			},
			methods:{
				tab_on:function(i){
					if( i == this.current_type ){
						return {tab_on:true};
					}else{
						return {};
					}
				},
				change_type:function(i){
					this.current_type = i;
				},
				//班级成绩统计
				change_class_data:function(type){//当用户点击tab时重新获取数据
					var self = this;
					my_require.R({
						isShade:1,
						url:'/report/classreport',
						data:{
							sessionid:getCookie('sessionid'),
							accountname:getCookie('userid'),
							command:"report/classreport",
							querytype:self.type_map[type]
						},
						callback:function(base){
							self.classname = base.classname;
							self.classstdcount = base.classstdcount;
							self.starttime = base.starttime;
							self.endtime = base.endtime;
							self.minscore = base.minscore;
							self.avgscore = base.avgscore;
							self.trainstdcount = base.trainstdcount;
							self.maxscore = base.maxscore;
							self.order = base.order;
							self.current_type2 = self.current_type;
						}
					});
				}
			},

			created:function(){
				
			},
			mounted:function(){
				this.change_class_data(this.current_type);
			},
			updated:function(){

			},
			watch:{
				current_type:function(val,oldval){
					this.change_class_data(val);
				}
			},
			computed:{
				
			}
		})
	</script>
</html>