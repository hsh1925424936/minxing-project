<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../../js/salesmanage/layout.js" ></script>
		<meta charset="UTF-8">
		<title>敏行营销管理后台</title>
		<style>
			body{
				height:100%;
			}
			#vue_control{
				width:100%; height:100%;
			}
			.pc_nav{
				width:195px; height:100%; background-color:#2D3133; position:fixed;
				left:0; top:0; z-index:10;
			}
			.pc_nav>h3{
				line-height:42px; color:white; background-color:#2088ca; text-align:center;
				font-weight:bold; letter-spacing:0.1em; font-size: 16px;
			}
			.pc_nav>ul{
				background-color:#1F2326; margin-top:20px; overflow:hidden;
			}
			.pc_nav>ul>li{
				border-top:2px solid #2D3134; height:74px; line-height:74px;
				cursor:pointer;
				position:relative;
			}
			.pc_nav>ul>li:nth-child(1){
				border-top:none;
			}
			/*pc端导航选中样式*/
			.pc_li_on{

			}
			.pc_li_on span{
				color:#2088ca !important;
			}
			.pc_li_on .white_tri{
				display:block !important;
			}
			.pc_nav>ul>li img{
				display:block; top:50%; margin-top:-12px; position:relative;
				width:24px; height:24px; float:left; margin-left:30px; margin-right:20px;
			}
			.pc_nav>ul>li span{
				display:block; font-size:16px; color:#cccccc; float:left;
			}
			.pc_nav>ul>li i{
				width:18px; height:18px; display:block;
				border-radius:15px; background-color:#E42021;
				color:white; line-height:16px; position:absolute; top:20px; right:36px;
				font-size:10px; font-style:normal; text-align:center;
			}
			.pc_nav .white_tri{
				display:none; top:50%; position:absolute; margin-top:-12px;
				right:0; border:12px solid transparent; border-right:12px solid white;
			}
			.pc_nav .upload_img{
				 display: block;
			    position: absolute;
			    width: 130px;
			    height: 36px;
			    border-radius: 30px;
			    bottom: 30px;
			    left: 50%;
			    margin-left: -65px;
			}
			.pc_nav #upload_file_input{
				display: block;
			    position: absolute;
			    width: 130px;
			    height: 36px;
			    border-radius: 30px;
			    bottom: 30px;
			    left: 50%;
			    margin-left: -65px;
			    z-index: 11;
			    opacity: 0;
			}

			.right_outer{
				width:100%; height:100%; overflow:hidden;
			}
			.top_bar{
				width:100%; height:42px; background-color:#F5F5F5; overflow:hidden;
				position:relative;
			}
			.top_bar span{
				line-height:45px; color:#333333; display:block; float:right;
				margin-right:10px;
			}
			.top_bar img{
				width:20px; height:20px; display:block; float:right;
				margin-top:-10px; top:50%; margin-right:30px; position:relative;
			}
			.right_con{
				width:100%; height:100%;
    			margin-top:-42px;
			}
			.right_inner{
				width:100%; height:100%;
			}
			#myiframe{
				width:100%; height:100%;
			}

			/*手机导航*/
			.phone_nav{
				width:262px; height:100%; background-color:#2D3133; position:fixed;
				left:-270px; top:0; z-index:20;
			}
			.phone_nav>h3{
				line-height:59px; color:white; background-color:#2088ca; text-align:center;
				font-weight:bold; letter-spacing:0.1em; font-size:18px;
			}
			.phone_nav>ul{
				background-color:#1F2326; margin-top:10px; overflow:hidden;
			}
			.phone_nav>ul>li{
				border-top:2px solid #2D3134; height:49px; line-height:49px;
				cursor:pointer;
				position:relative;
			}
			.phone_nav>ul>li:nth-child(1){
				border-top:none;
			}
			/*phone端导航选中样式*/
			.phone_li_on{

			}
			.phone_li_on span{
				color:#2088ca !important;
			}
			.phone_nav>ul>li img{
				display:block; top:50%; margin-top:-11px; position:relative;
				width:22px; height:22px; float:left; margin-left:30px; margin-right:47px;
			}
			.phone_nav>ul>li span{
				display:block; font-size:15px; color:#cccccc; float:left; position:relative;
			}
			.phone_top_bar{
				width:100%; height:44px; background-color:#1F2325; position:relative;
				display:none;
			}
			.phone_top_bar img{
				width:21px; height:17.5px; display:block;
				position:absolute; top:50%; left:15px; margin-top:-8.75px;
			}
			.phone_top_bar h3{
				height:100%; line-height:44px; text-align:center;
				color:#ffffff; font-size:15px;
			}

			/*适配手机端*/
			@media screen and (max-width: 800px) {
				.pc_nav,.top_bar{
					display:none;
				}
				.phone_top_bar{
					display:block;
				}
				.right_con{
					height:100%; margin-top:-44px;
				}
			}

		</style>	
	</head>
	<body>
		<div id="vue_control" v-cloak>
			<nav class="pc_nav">
				<h3>敏行营销管理后台</h3>
				<ul>
					<li v-for="(value,i) in nav" :src="value.url" @click="clicktab(value,'pc')" :class="pc_changetab(value)">
						<img :src="value.img">
						<span>{{value.name}}</span>
						<i v-if="value.name == '激活管理' && value.num > 0">{{value.num}}</i>
						<div class="white_tri"></div>
					</li>
					
				</ul>

				<!-- <img src="../../images/salesmanage/upload_btn.png" class="upload_img" />
				<input type="file" id="upload_file_input"> -->
			</nav>

			<nav class="phone_nav">
				<h3>敏行营销</h3>
				<ul>
					<li v-for="(value,i) in nav" :class="phone_changetab(value)" :src="value.url" @click="clicktab(value,'phone')">
						<img :src="value.img">
						<span>{{value.name}}</span>
					</li>
					<li src="requiremanage.html" class="loginout" @click="loginout">
						<img src="../../images/salesmanage/loginout.png">
						<span>退出账户</span>
					</li>
					
				</ul>
			</nav>

			<div class="right_outer">
				<div class="top_bar">
					<img src="../../images/salesmanage/loginout.png" class="loginout"  @click="loginout"/><span>{{username}}</span>
				</div>
				<div class="phone_top_bar">
					<img src="../../images/salesmanage/assistor.png" class="open_nav" @click="open_nav">
					<h3>{{nownav.name}}</h3>
				</div>

				<div class="right_con">
					<div class="right_inner">
						<iframe :src="nownav.url" id="myiframe" name="myiframe"></iframe>
					</div>
				</div>
			</div>

		</div>
	</body>

	<script type="text/javascript">
		var vm;
		onload = function(){
			vm=new Vue({
				el:"#vue_control",
				data:{
					nav:[
						{
							url:'usermanage.html',
							img:'../../images/salesmanage/usermanage.png',
							name:'用户管理'
						},
						{
							url:'requiremanage.html',
							img:'../../images/salesmanage/requiremanage.png',
							name:'激活管理',
							num:0
						}
					],
					nownav:{
							url:'usermanage.html',
							img:'../../images/salesmanage/usermanage.png',
							name:'用户管理'
					},
					username:codetostr(getCookie('username'))
				},
				methods:{
					clicktab:function(nownav,type){//切换导航
						if( this.nownav.name == nownav.name ){
							return false;
						}
						this.nownav = nownav;
						if( type == 'phone' ){
							$('.phone_nav').animate({left:'-270px'});
							shade.shadeClose();
						}
					},
					//切换导航后改变选项卡样式
					pc_changetab:function(oldnav){
						if( this.nownav.name == oldnav.name ){
							return {'pc_li_on':true};
						}else{
							return {'pc_li_on':false};
						}
					},
					phone_changetab:function(oldnav){
						if( this.nownav.name == oldnav.name ){
							return {'phone_li':true,'phone_li_on':true};
						}else{
							return {'phone_li':false,'phone_li_on':false};
						}
					},
					open_nav:function(){//打开手机导航
						shade.shadeOpen();
						$('.phone_nav').animate({left:0});
						$('.myshade').click(function(){
							$('.phone_nav').animate({left:'-270px'});
							shade.shadeClose();
						})
					},
					loginout:function(){
						$('.phone_nav').animate({left:'-270px'});
						shade.shadeClose();
						open_dialog1({
							title:'退出',
							content:'确定要退出登录吗？',
							yesbtnname:'退出',
							yes:function(){
								my_require.R({
									isShade:1,
									url:'/mismarketing/logout',
									data:{
										command:"mismarketing/logout",
										loginuserid:getCookie('userid'),
									},
									callback:function(base){
										location.href = 'login.html';
									}
								});
							}
						});
					},
					activenum:function(){//返回需要激活的人数
						var self = this;
						my_require.R({
							url:'/mismarketing/queryactivdteuser',
							data:{
								command:"mismarketing/queryactivdteuser",
								activateDays:7,
								requestpage:1,
								sizeperpage:10000,
								userid:getCookie('userid')
							},
							callback:function(base){
								if( base.usersList ){
									self.nav[1].num = base.usersList.length;
								}else{
									self.nav[1].num = 0;
								}
								
							}
						});
					}
				},

				created:function(){
					this.activenum();
				},
				watch:{
					
				}
			})		
		}

	</script>
</html>