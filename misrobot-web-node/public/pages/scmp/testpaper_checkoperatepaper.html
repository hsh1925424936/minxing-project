<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
		<title>查看试卷-操作题库</title>
		<link rel="stylesheet" href="../../bootstrap-3.3.5-dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="../../css/element.css">
		<link rel="stylesheet" href="../../css/scmp/testpaper_addnew.css">
		<style>
			.right{padding: 0;}
		</style>
	</head>

	<body>
		<div id="addnew" v-cloak>
			<p id="addnewtestpaper">查看试卷-操作题库  <button class="btn btn-primary gobackbtn" @click="goback">返回</button> </p>
			<div id="selectQ">
				<!--*********************************按钮 搜索部分************************************-->
				<div class="center search-wrap">
					<form class="form-inline" style="float:none;">
						<div class="form-group">
							<label>试卷名称：</label><span>{{papername}}</span>
							<label>试卷类型：</label><span>操作题库</span>
							<label>所属学科：</label><span>{{coursename}}</span>
							<label>试卷总分：</label><span>{{score}}</span>
							<label>题目总数：</label><span>{{questiontotalnum}}</span>
						</div>
					</form>
				</div>
				<!--*********************************选择题目表格部分************************************-->
				<div style="clear: both;">
					<table class="table table-bordered table-hover">
						<tr class="active">
							<th  class="middle">序号</th>
							<th  class="middle">题目名称</th>
							<!--<th  class="middle">题目类型</th>-->
							<th  class="middle">所属学科</th>
							<!--<th  class="middle">标签</th>
							<th  class="middle">难度</th>-->
							<th  class="middle">分值</th>
							<th  class="middle">操作</th>
						</tr>
						<tr v-for="(item,index) in questionlist">
							<td class="middle">{{index+1}}</td>
							<td class="middle">{{item.questionname}}</td>
							<td class="middle">{{item.coursename}}</td>
							<!--<td class="middle">{{item.tag}}</td>
							<td class="middle">{{item.difficult}}</td>-->
							<td class="middle">{{item.questiontypeid | typetransform}}</td>
							<td class="middle">
								<button type="button" class="btn btn-primary btn-xs" @click="checkquestion(item.questiontypeid,item.questionbaseid)">查看</button>
							</td>
						</tr>
					</table>
				</div>
				<!--************************************************分页**************************************-->
				<!--<page_component :pageconf="pageconf" :pages="pages"></page_component>-->
				
				<div class="next"> 
					<button type="button" class="btn btn-primary" @click="cancel">返回</button>
				</div>
			</div>
		</div>

	</body>
	<script src="../../js/jquery-3.1.1.min.js"></script>
	<script src="../../js/vue.js"></script>
	<script src="../../js/element.js"></script>
	<script src="../../layer/xie/layer1.js"></script>
	<script src="../../js/scmp/common.js"></script>
	<script src="../../bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
	<script src="../../js/scmp/pageComponent.js"></script>
	
	<script>

Vue.filter('typetransform',function(value){
	var name=value;
	switch (value){
		case 1: name="单选";
			break;
		case 2: name="多选";
			break;
		case 3: name="不定项选择题";
			break;
		case 4: name="判断题";
			break;
		case 5: name="问答题";
			break;
		case 6: name="组合题";
			break;
		case 7: name="osce操作题";
			break;
		case 8: name="learn训练操作题";
			break;
		default:
			break;
	}
	return name;
})

var vm = new Vue({
	el: '#addnew',
	data: {
		papername:'',//试卷名称
		papertype:'',//试卷类型
		coursename:'',//所属学科
		score :'',
		score:'',//试卷总分
		questionlist:[],//查询全部试题列表
		questiontotalnum:'',//试题总数
		pageconf: {
			itemsPerPage:10,//默认显示10条
			current: 1, //默认显示第一页
			showItem: 10, //最多显示多少页，自己定义
			allpage: '', //总共多少页，根据请求返回结果计算
			totalnum: '', //总共条数，请求返回
			onchange: function() { 
				var data = {
						command:"exampaper/queryselectedquestion",
						sessionid:getCookie('sid'),
						loginid:getCookie('uid'),
//						page:index,
//						reqnum:itemsperpage,
						paperid:location.href.split('=')[1],//试卷id
						questiontypeid:7,
					};
					function callback(res) {
						vm.questionlist=res.questionlist;
						vm.questiontotalnum=res.allcount;
					};
					post("/exampaper/queryselectedquestion", data, callback, errcodefn, errfn)
			}
		},
	},
	mounted:function(){
		this.pageconf.onchange();
		this.queryCourse();
		this.querypapername();
	},
	methods: {
		goback:function(){//返回
			window.history.go(-1)
		},
		querypapername:function(){//查询试卷名称
			var self=this
            var data={
                command:"exampaper/viewpaper",
                sessionid:getCookie('sid'),
                loginid:getCookie('uid'),
				paperid:location.href.split('=')[1],
            }
            function callback(res){
            	vm.papername=res.paperinfo.name;
            	vm.papertype=res.paperinfo.type;
            	vm.coursename=res.paperinfo.majorname;
            	vm.score=res.paperinfo.score;
            }
            post("/exampaper/viewpaper",data,callback,errcodefn,errfn)
		},
		queryCourse:function(){//查询学科列表
			var self=this
            var data={
                command:"cls/selectCourses",
                sessionid:getCookie('sid'),
                loginid:getCookie('uid')
            }
            function callback(res){
            	self.courselist=res.courseslist;
            }
            post("/cls/selectCourses",data,callback,errcodefn,errfn)
		},
		checkquestion:function(type,questionbaseid){//查看试题
			console.log('----------')
			if(type == 1) {
				layer.open({
					type: 2,
					title: '查看题目-单选题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-danxuan.html?id=' + questionbaseid
				})
			} else if(type == 2) {
				layer.open({
					type: 2,
					title: '查看题目-多选题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-duoxuan.html?id=' + questionbaseid
				})
			} else if(type == 4) {
				layer.open({
					type: 2,
					title: '查看题目-判断题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-panduan.html?id=' + questionbaseid
				})
			} else if(type == 5) {
				layer.open({
					type: 2,
					title: '查看题目-问答题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-wenda.html?id=' + questionbaseid
				})
			} else if(type == 6) {
				layer.open({
					type: 2,
					title: '查看题目-组合题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-zuhe.html?id=' + questionbaseid
				})
			} else if(type == 7) {
				layer.open({
					type: 2,
					title: '查看题目-操作题',
					area: ['100%', '100%'],
					shadeClose: true,
					content: './look-caozuo.html?id=' + questionbaseid
				})
			}
		},
		cancel:function(){
			window.location.assign("./testpaperManage.html")
		},
	},
	computed: {
		pages: function() {
			var pag = [];
			if(this.pageconf.current < this.pageconf.showItem) { //如果当前的激活的项 小于要显示的条数
				//总页数和要显示的条数那个大就显示多少条
				var i = Math.min(this.pageconf.showItem, this.pageconf.allpage);
				while(i) {
					pag.unshift(i--);
				}
			} else { //当前页数大于显示页数了
				var middle = this.pageconf.current - Math.floor(this.pageconf.showItem / 2), //从哪里开始
					i = this.pageconf.showItem;
				if(middle > (this.pageconf.allpage - this.pageconf.showItem)) {
					middle = (this.pageconf.allpage - this.pageconf.showItem) + 1
				}
				while(i--) {
					pag.push(middle++);
				}
			}
			return pag
		}
	},
});

	</script>
</html>