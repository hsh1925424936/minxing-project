<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>修改设备</title>
		<link rel="stylesheet" href="../../bootstrap-3.3.5-dist/css/bootstrap.min.css" />
		<script src="../../js/jquery-1.11.3.js"></script>
		<script src="../../layer/xie/layer1.js"></script>
		<script src="../../js/scmp/common.js"></script>
		<script src="../../js/vue.js"></script>
		<link rel="stylesheet" href="../../css/assistant/style.css">
		<link rel="stylesheet" href="../../css/scmp/scmpcommon.css">
	</head>
	<style>
		body {
			overflow: auto;
		}
		
		.add_site {
			text-align: left;
		}
		
		.col-sm-9 p {
			line-height: 30px;
		}
	</style>

	<body>
		<div id="add_site" v-cloak style="margin: 30px 15%;">
			<div class="s_addStudent" style="z-index: 99999;">
				<div class="s_studentMessage">
					<ul>
						<li>
							<form class="form-horizontal">
								<div class="col-md-8">
									<div class="form-group form-group-sm">
										<label class="col-sm-3 control-label">设备类型：</label>
										<div class="col-sm-9">
											<p>{{devicetypecn}}</p>
										</div>
									</div>
								</div>
							</form>
						</li>
						<li>
							<form class="form-horizontal">
								<div class="col-md-8">
									<div class="form-group form-group-sm">
										<label class="col-sm-3 control-label">设备考组：</label>
										<div class="col-sm-9">
											<p>{{oscegroup}}</p>
										</div>
									</div>
								</div>
							</form>
						</li>
						<li>
							<form class="form-horizontal">
								<div class="col-md-8">
									<div class="form-group form-group-sm">
										<label class="col-sm-3 control-label">*设备名称：</label>
										<div class="col-sm-9">
											<input class="form-control " type="text" v-model="devicename">
										</div>
									</div>
								</div>
							</form>
						</li>
						<li>
							<form class="form-horizontal">
								<div class="col-md-8">
									<div class="form-group form-group-sm">
										<label class="col-sm-3 control-label">设备描述 ：</label>
										<div class="col-sm-9">
											<input class="form-control " type="text" v-model="devicespec">
										</div>
									</div>
								</div>
							</form>
						</li>
						<li>
							<form class="form-horizontal">
								<div class="col-md-8">
									<div class="form-group form-group-sm">
										<label class="col-sm-3 control-label"></label>
										<div class="col-sm-9">
											<p>说明 ：修改设备的相关资料以及属性</p>
										</div>
									</div>
								</div>
							</form>
						</li>
					</ul>
				</div>
				<div style="clear:both;overflow:hidden;padding:25px 30px 0 0;text-align: center;" class="bt_add">
					<button class="btn btn-default" type="submit" v-on:click="cancel" style="float: left;margin-left: 45%;">取消</button>
					<button class="btn btn-primary" type="submit" v-on:click="save" style="float:left;margin-left: 20px;">保存</button>
				</div>
			</div>
		</div>
		<script>
			var vm = new Vue({
				el: '#add_site',
				data: {
					data: '',
					devicetype:'',
					devicenum:'',
					devicename: '',
					devicetypecn: '',
					paramlist: [],
					resultlist: '',
					devicespec: '',
					oscegroup:''
				},
				mounted: function() {
					this.get_result();
					this.get_data();
				},
				methods: {
					get_data: function() {
						var self = this;
						self.data = window.parent.vm.val;
						self.devicenum = self.data.id;
						self.devicename = self.data.devicename;
						self.devicetypecn = self.data.devicetypecn;
						self.devicetype = self.data.devicetype;
						self.devicespec = self.data.devicespec;
						self.oscegroup=self.data.oscegroup;
					},
					cancel: function() {
						var index = parent.layer.getFrameIndex(window.name);
						parent.layer.close(index)
					},
					get_result: function() {
						var self = this
						var data = {
							command: 'oscearea/queryareainfo',
							sessionid: getCookie('sid'),
							loginid: getCookie('uid'),
						}

						function callback(res) {
							self.resultlist = res.resultlist;
						}
						post('/oscearea/queryareainfo', data, callback, errcodefn, errfn)
					},
					save: function() {
						var self = this;
						var re = /^[\u4E00-\u9FA5A-Za-z0-9]+$/;
						if(self.devicename != '' && !re.test(self.devicename)) {
							layer.msg('设备名称不能包含特殊字符');
							return
						}
						if(self.devicespec != '' && !re.test(self.devicespec)) {
							layer.msg('设备描述不能包含特殊字符');
							return
						}
						if(self.devicename=='') {
							layer.msg('带*号的为必填项')
						} else {
							var data = {
								command: 'oscedevice/updateoscedevice',
								sessionid: getCookie('sid'),
								loginid: getCookie('uid'),
								id: self.devicenum,
								devicename: self.devicename,
								devicespec: self.devicespec
							}
							function callback(res) {
								layer.msg('编辑成功');
								setTimeout(function() {
									self.cancel();
									var page = window.location.href.split('=')[1].split('&')[0];
								    var num = window.location.href.split('=')[2];
									window.parent.vm.pageconf.onchange(page,num);
								}, 1000)
							}
							post('/oscedevice/updateoscedevice', data, callback, errcodefn, errfn)
						}
					},
				}
			})
		</script>
	</body>

</html>