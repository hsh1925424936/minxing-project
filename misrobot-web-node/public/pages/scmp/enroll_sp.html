<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>培训报名审核</title>
		<link rel="stylesheet" href="../../bootstrap-3.3.5-dist/css/bootstrap.min.css" />
		<script src="../../js/jquery-1.11.3.js"></script>
		<script src="../../layer/xie/layer1.js"></script>
		<script src="../../js/scmp/common.js"></script>
		<script src="../../js/vue.js"></script>
		<link rel="stylesheet" href="../../css/assistant/style.css">
		<link rel="stylesheet" href="../../css/scmp/scmpcommon.css">
	</head>
	<style>
		.beizhu {
			resize: none;
			width: 335px;
			height: 132px;
			max-width: 335px;
			max-height: 132px;
		}
		
		
	</style>

	<body>
		<div class="shenhe">
			<div style="padding:20px 20.5%;">
				<form action="choose" method="post">
					<label style="width: 50%;"><input type="radio" value="2" v-model="agreeStatus" />同意</label>

					<label><input type="radio" value="0" v-model="agreeStatus" />不同意</label>
				</form>
			</div>
			<div style="padding: 0 18% 0 5%;overflow: hidden;">
				<p style="float: left;width: 20%;text-align: right;">备注：</p>
				<div style="float: left;">
				    <textarea class="beizhu" v-model="remarks"></textarea>
				</div>
				<p style="float: left;width: 100%;text-align: center; margin-top: 5%;color:#F00;">该培训计划当前审核通过人数为{{limite}}人次,报名人数上限为{{limited_count}}人次</p>
			</div>
			<div style="padding: 20px 30%;display: flex;justify-content: space-around;">
				<button class="btn btn-primary" type="submit" @click="save" style="text-align: center;">提交</button>
				<button class="btn btn-default" @click="cancel" style="text-align: center;">取消</button>
				
			</div>
		</div>
		<script>
		</script>
	</body>

</html>
<script type="text/javascript">
	var vm = new Vue({
		el: '.shenhe',
		data: {
			agreeStatus: '',
			remarks: '',
			limite:'',//当前已审核通过人数
			limited_count:'',//报名人数上限
		},
		mounted: function() {
			this.show_limite();
		},
		methods: {
			cancel: function() {
				closeAll();
			},
			save: function() {
				var self = this;
				if(self.agreeStatus != '') {
					var data = {
						command: 'approvemanage/approve', //接口地址
						sessionid: getCookie('sid'),
						loginid: getCookie('uid'),
						id: window.location.href.split('=')[1],
						sign_status: self.agreeStatus,
						remark: self.remarks
					};
					function callback(res) {
						window.parent.vm.activeName="first"
						window.parent.vm.show_approve();
						closeAll();
					};
					post('/approvemanage/approve', data, callback, errcodefn, errfn)
				} else {
                     layer.msg('请选择同意或者不同意')
				}

			},
			show_limite:function(){
				var self=this;
				var data={
					command:'approvemanage/querylimite',
					sessionid: getCookie('sid'),
					loginid: getCookie('uid'),
					single_id: window.location.href.split('=')[1],
				};
				function callback(res){
					self.limite=res.limite;
					self.limited_count=res.limited_count;
				};
				post('/approvemanage/querylimite', data, callback, errcodefn, errfn)
			}
		}
	})
</script>