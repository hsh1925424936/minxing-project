<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>新建问答题</title>
    <script src="../../js/jquery-1.11.3.js"></script>
    <script src="../../layer/xie/layer1.js"></script>
    <script src="../../js/scmp/common.js"></script>
    <script src="../../js/vue.js"></script>
    <script src="../../js/scmp/newq_compo.js"></script>
    <script src="../../bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../../bootstrap-3.3.5-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../css/scmp/addqcommon.css">
</head>
<body>
<div class="container">
    <cpagetitle :title="pagetitletext" :showback="true"></cpagetitle>
    <cmain :maintitle="maintitle[0]">
        <div class="maincontent">
            <textarea cols="30" rows="10" class="form-control" placeholder="输入题目名称,300字以内" v-model="qname" maxlength="300"></textarea>
        </div>
    </cmain>
    <cmain :maintitle="maintitle[1]">
        <div class="maincontent">
            <textarea cols="30" rows="10" class="form-control" placeholder="输入答案,300字以内" v-model="qanswer" maxlength="300"></textarea>
        </div>
    </cmain>
    <cmain :maintitle="maintitle[2]">
        <div class="flexcenter">
            <span class="labeltitle">所属学科</span>
            <select class="form-control labelcontent" v-model="seldiscipline">
                <option value="">请选择学科</option>
                <option v-for="(v,i) in disciplinelist" :value="v.id">{{ v.name }}</option>
            </select>
        </div>
    </cmain>
    <cfooter :submitnewq="submitnewq"></cfooter>
</div>
<script>
    var vm=new Vue({
        el:'.container',
        data:{
            qanswer:'',
            qname:'',
            disciplinelist:[],//学科列表
            seldiscipline:'',
            pagetitletext:'新增题目-问答',//页面标题
            maintitle:['题目名称','答案','设置'],//页面主模块标题
        },
        mounted:function(){
            this.querydiscipline()
        },
        methods:{
            querydiscipline:function(){//查询学科接口
                var self=this
                var data={
                    command:"cls/selectCourses",
                    sessionid:getCookie('sid'),
                    loginid:getCookie('uid')
                }
                function callback(res){
                    self.disciplinelist=res.courseslist
                }
                post("/cls/selectCourses",data,callback,errcodefn,errfn)
            },
            submitnewq:function(){//保存添加题目接口
                if(this.qname==''){
                    layer.msg('请输入题干内容')
                    return
                }
                if(this.qanswer==''){
                    layer.msg('请设置正确答案')
                    return
                }
                if(this.seldiscipline==''){
                    layer.msg('请选择题目所属学科')
                    return
                }
                var data={
                    command:'question/addquestioninfo',
                    sessionid:getCookie('sid'),
                    loginid:getCookie('uid'),
                    creatorid:getCookie('uid'),
                    name:this.qname,
                    cateid:5,
                    courseid:this.seldiscipline,
                    answer:this.qanswer,
                }
                function callback(res){
                    var L=layer.confirm('添加题目成功!', {
                        btn: ['继续添加','不再添加'] //按钮
                    }, function(){
                        layer.close(L)
                        window.location.reload()
                    }, function(){
                        layer.close(L)
                        window.history.go(-1)
                    })
                }
                post('/question/addquestioninfo',data,callback,errcodefn,errfn)
            }
        }
    })
</script>
</body>
</html>