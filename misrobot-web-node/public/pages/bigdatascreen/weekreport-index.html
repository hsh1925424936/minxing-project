<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="../../js/bigdatascreen/layout.js" ></script>
		<link rel="stylesheet" href="../../css/bigdatascreen/week-report.css" type="text/css" />
		<script src="../../js/bigdatascreen/week-report.js" type="text/javascript" charset="utf-8"></script>
		<meta charset="UTF-8">
		<title>大数据周报</title>
		<style>
			/*显示整屏*/
			.allscreen{
				background-color:#161823; height:100%; width:100%;
				position:absolute; left:0; top:0;
			}
			.u3d{
				float:left; width:66.6%; height:100%;
			}
			/*右侧网页部分*/
			.right_outer{
				float:left; width:33.3%; height:100%;
			}
			/*右侧轮播显示*/
			.swiperouter{
				height:88vh;
			}
			.swiper-container{
				width:100%;
			}
			.swiper-container,.swiper-wrapper,.swiper-slide{
				height:100%;
			}

			.detailpage{
				width:100%; height:100%; position:absolute; left:100%; top:0;
			}
		</style>	
	</head>
	<body>
		<div class="allscreen clearfix">
			<iframe src="../../u3d/bigdatascreen/BigData/Desktop.html" class="u3d"></iframe>
			<div class="right_outer" id="vue_control" v-cloak>
				<!-- 右侧标题 -->
				<div class="top_tit_outer">
					<div class="top_tit">
						<img src="../../images/bigdatascreen/btn_return.png" class="btn_enter" @click="show_week_detail">
						<div class="top_tit_inner">
							<span class="top_tit_span1">管理者周报（{{timefromto}}）</span>
							<span class="top_tit_span2">本周教学工作开展良好</span>
						</div>
					</div>
				</div>
				<div class="swiperouter">
					<div class="swiper-container">
				        <div class="swiper-wrapper">
				            <div class="swiper-slide swiper-no-swiping">
				            	<c-teacher-week :teacherscorereport="teacherscorereport" :teacherclassreport="teacherclassreport"></c-teacher-week>
				            </div>
				            <div class="swiper-slide swiper-no-swiping">
				            	<c-student-week :studentscorereport="studentscorereport" :studentclassreport="studentclassreport"></c-student-week>
				            </div>
				            <div class="swiper-slide swiper-no-swiping">
				            	<c-environment-week :teacherclasstimes="teacherclasstimes" :studentclasstimes="studentclasstimes"></c-environment-week>
				            </div>
				        </div>
				    </div>
				</div>
			</div>
		</div>

		<iframe src="weekreport.html" class="detailpage weekdetail"></iframe>
	</body>

	<script type="text/javascript">
		var vm;
		onload = function(){
			vm=new Vue({
				el:"#vue_control",
				data:{
					teacherscorereport:[],//老师得分周报
					teacherclassreport:[],//老师学时完成周报
					studentscorereport:[],//学生得分周报
					studentclassreport:[],//学生学时完成周报
					teacherclasstimes:[],//老师上课人次数组
					studentclasstimes:[],//学生上课人次数组
					lastmonday:'',//本周开始时间
					lastfriday:''//本周结束时间
				},
				methods:{
					show_week_detail:function(){//展示详情页
						$('.u3d').addClass('hidden');
						$(".allscreen").animate({
							left:'-100%'
						},function(){
							$('.u3d').removeClass('hidden');
						});
						$('.weekdetail').animate({
							left:'0'
						});

					},
					show_index:function(){//返回主页
						$('.u3d').addClass('hidden');
						$(".allscreen").animate({
							left:'0'
						},function(){
							$('.u3d').removeClass('hidden');
						});
						$('.detailpage').animate({
							left:'100%'
						});
					}
				},

				created:function(){
					
				},
				mounted:function(){
					var swiper = new Swiper('.swiper-container', {
				        pagination: '.swiper-pagination',
				        paginationClickable: true,
				        spaceBetween: 0,
				        centeredSlides: true,
				        autoplay: 5000,
				        speed:2000,
				        autoplayDisableOnInteraction: false,
				        noSwiping : true
				    });

					var self = this;
				    my_require.R({
						isShade:1,
						url:'/bigdata/reportweek/queryreportweek',
						data:{
							command:"bigdata/reportweek/queryreportweek"
						},
						callback:function(base){
							self.teacherscorereport = base.teacherscorereport;
							self.teacherclassreport = base.teacherclassreport;
							self.studentscorereport = base.studentscorereport;
							self.studentclassreport = base.studentclassreport;
							self.teacherclasstimes = base.teacherclasstimes;
							self.studentclasstimes = base.studentclasstimes;
							self.lastmonday = base.lastmonday;
							self.lastfriday = base.lastfriday;
						}
					});
				},
				updated:function(){

				},
				watch:{

				},
				computed:{
					timefromto:function(){
						var str = '';
						if(this.lastmonday && this.lastfriday){
							var startdate = this.lastmonday.split('-');
							var enddate = this.lastfriday.split('-');
							str = startdate[0]+'.'+startdate[1]+'.'+startdate[2]+'-'+enddate[1]+'.'+enddate[2];
							if ( startdate[0] != enddate[0] ){//如果跨年了
								str = startdate[0]+'.'+startdate[1]+'.'+startdate[2]+'-'+enddate[0]+enddate[1]+'.'+enddate[2];
							}
						}
						
						return str;
					}
				},
				components:{
					'c-teacher-week':c_teacher_week,
					'c-student-week':c_student_week,
					'c-environment-week':c_environment_week
				}
			})
		}

	</script>
</html>